{%extends "_layout.html"%}
{%block content%}
    <div class="">
    <div class="d-inline-flex ">


        <div class="userbox m-3 ">
   
       <div class="d-flex justify-content-center m-3">
             <div style="position:relative">
    {% if user.username == current_user.username %}
        <button type="button" class="photo-link btn btn-link" data-toggle="modal" data-target="#newProfilePicture" style="position:absolute;bottom:0;">New profile picture</button>
    {% endif %}
          <img  class="profile-image" style = "width:300px;height:300px" src = "{{user.profile_image_url}}">
        </div>
       </div>

       <h3 class="d-flex justify-content-center"><em>{{user.username}}</em></h3>

        <hr>
        <div class="main-wrapper">
            {%if user.power%}
            <div class="badge yellow">
                <div class="circle"></div>
                <div class="ribbon">Power</div>
            </div>
            {%endif%}
            {%if user.endurance%}
            <div class="badge orange">
                <div class="circle"> </i></div>
                <div class="ribbon">Endurance</div>
            </div>
            {%endif%}
            {%if user.calisthenics%}
            <div class="badge pink">
                <div class="circle"> </div>
                <div class="ribbon">Calistanic</div>
            </div>
            {%endif%}
            {%if user.teamsports%}
            <div class="badge red">
                <div class="circle"></div>
                <div class="ribbon">Team Sport</div>
            </div>
            {%endif%}
            <hr>
            <p>Bio</p>
            <div class="bio_body m-3">
                {{ user.bio }}
            </div>
            <hr>
            <div>
                Bicep Measurement
        
            </div>
        </div>         
     </div>
    <div class="wrappertwo">

            <div class="content_image m-3 ">
    
            {%for image in user.images%}
            <div class='user-image'>
                {% if current_user.id == user.id %}
                    <form action="{{ url_for('images.delete', id=image.id) }}" method="POST">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        
                        <button class="btn delete-image">Delete</button>
                    </form>
                {% endif %}
                <a href="{{ url_for('images.display_img', id=image.id) }}">
                    <img class="w-100" src = "{{image.image_url}}" />
                </a>
            
            </div>
            {%endfor%}
            </div>

        </div>
        
        {%if current_user.is_authenticated%}
        {%if current_user.id != user.id%}
        {%if current_user.is_follow(user.id)%}
        
        <form action="{{url_for('fan_idol.unfollow', id = user.id)}}" method = 'POST'>
            <div>
                <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
            </div>
            
            <input type="submit" class ='btn btn-outline-danger' name = 'Unfollow' value = 'Unfollow'>  
        </form>
        
        {%else%}
        
        <form action="{{url_for('fan_idol.follow', id = user.id)}}" method = 'POST'>
            <div>
                <input type="hidden" name="csrf_token" value="{{csrf_token()}}">
            </div>
        
                <input type="submit" class ='btn btn-outline-success' name = 'follow' value = 'Follow'>  
        </form>
        
        {%endif%}
        {%endif%}
        {%endif%}
    </div>
    </div>


<div class="modal fade" id="newProfilePicture" tabindex="-1" role="dialog" aria-labelledby="newProfilePictureTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="newProfilePictureTitle">Upload profile photo</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                    <form class="text-center" action="{{ url_for('images.upload_file', id=user.id)}}" method="POST" enctype="multipart/form-data">
                        
                        <input type="file" name="user_file" id="user_file" class="inputfile mb-0" onchange="viewProfileImage(this)"/>
                        <label class="mb-0" for="user_file">Choose a file</label>
                
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button class="btn btn-outline-secondary" type="submit">Upload</button>
                       
                    </form>

                    <div id="profile_image_viewer" class="mt-3">
                        <img id="profile_image_placeholder" class='profile-image upload-view' src="https://www.fwhealth.org/wp-content/uploads/2017/03/placeholder-500x500.jpg">
                    </div>
            </div>
        </div>
    </div>
</div>

{%endblock%}